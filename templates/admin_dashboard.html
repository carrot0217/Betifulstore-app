<!DOCTYPE html>
<form method="get" style="margin-bottom: 20px;">
  ì‹œì‘ì¼: <input type="date" name="start" value="{{ start_date }}">
  ì¢…ë£Œì¼: <input type="date" name="end" value="{{ end_date }}">

  ë§¤ì¥ ì„ íƒ:
  <select name="store">
    <option value="">ì „ì²´ ë³´ê¸°</option>
    {% for store in store_list %}
      <option value="{{ store }}" {% if store == selected_store %}selected{% endif %}>{{ store }}</option>
    {% endfor %}
  </select>

  í’ˆëª© ì„ íƒ:
  <select name="item">
    <option value="">ì „ì²´ ë³´ê¸°</option>
    {% for item in item_list %}
      <option value="{{ item }}" {% if item == selected_item %}selected{% endif %}>{{ item }}</option>
    {% endfor %}
  </select>

  <button type="submit">ì¡°íšŒ</button>
</form>

<html>
<head>
  <title>ê´€ë¦¬ì í†µê³„ ëŒ€ì‹œë³´ë“œ</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background-color: #f9f5f0;
      padding: 30px;
      color: #333;
    }
    h1 {
      color: #444;
    }
    .stat-box {
      background: #fff3e6;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.05);
    }
    canvas {
      margin-top: 20px;
      background: #fff;
      padding: 10px;
      border-radius: 8px;
    }
    a {
      display: inline-block;
      margin-top: 30px;
      color: #336699;
    }
  </style>
</head>
<body>
  <h1>ğŸ“Š ê´€ë¦¬ì í†µê³„ ëŒ€ì‹œë³´ë“œ</h1>

  <div class="stat-box">
    <p><strong>ì´ ì£¼ë¬¸ ê±´ìˆ˜:</strong> {{ total_orders }}ê±´</p>
    <p><strong>ì´ ì£¼ë¬¸ ìˆ˜ëŸ‰:</strong> {{ total_quantity }}ê°œ</p>
  </div>

  <h3>ğŸ¬ ë§¤ì¥ë³„ ì£¼ë¬¸ ê±´ìˆ˜</h3>
  <canvas id="storeChart"></canvas>

  <h3>ğŸ“¦ ìƒí’ˆë³„ ëˆ„ì  ì£¼ë¬¸ ìˆ˜ëŸ‰</h3>
  <canvas id="itemChart"></canvas>

  <h3>ğŸ“… ìµœê·¼ 7ì¼ ì£¼ë¬¸ ì¶”ì´</h3>
  <canvas id="dailyChart"></canvas>

  <h3>ğŸ† ì£¼ë¬¸ëŸ‰ TOP 5 ìƒí’ˆ</h3>
  <canvas id="topChart"></canvas>

  <a href="/admin">â† ê´€ë¦¬ì í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°</a>

  <script>
    const storeChart = new Chart(document.getElementById('storeChart'), {
      type: 'bar',
      data: {
        labels: {{ store_counts.keys() | list | tojson }},
        datasets: [{
          label: 'ë§¤ì¥ë³„ ì£¼ë¬¸ ê±´ìˆ˜',
          data: {{ store_counts.values() | list | tojson }},
          backgroundColor: '#ffd6a5'
        }]
      }
    });

    const itemChart = new Chart(document.getElementById('itemChart'), {
      type: 'bar',
      data: {
        labels: {{ item_counts.keys() | list | tojson }},
        datasets: [{
          label: 'ìƒí’ˆë³„ ì£¼ë¬¸ ìˆ˜ëŸ‰',
          data: {{ item_counts.values() | list | tojson }},
          backgroundColor: '#ffadad'
        }]
      }
    });

    const dailyChart = new Chart(document.getElementById('dailyChart'), {
      type: 'line',
      data: {
        labels: {{ recent_7_days | tojson }},
        datasets: [{
          label: 'ì¼ë³„ ì£¼ë¬¸ ê±´ìˆ˜',
          data: {{ daily_data | tojson }},
          backgroundColor: 'rgba(173,216,230,0.4)',
          borderColor: '#74c0fc',
          fill: true
        }]
      }
    });

    const topChart = new Chart(document.getElementById('topChart'), {
      type: 'bar',
      data: {
        labels: {{ top_items | map(attribute=0) | list | tojson }},
        datasets: [{
          label: 'TOP 5 ìƒí’ˆ ì£¼ë¬¸ ìˆ˜ëŸ‰',
          data: {{ top_items | map(attribute=1) | list | tojson }},
          backgroundColor: '#b5ead7'
        }]
      }
    });
  </script>
</body>
</html>
